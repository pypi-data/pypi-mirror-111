(this.webpackJsonpwww=this.webpackJsonpwww||[]).push([[0],{173:function(e,t,a){},174:function(e,t,a){},271:function(e,t,a){"use strict";a.r(t);var s,n=a(0),i=a.n(n),c=a(24),r=a.n(c),o=(a(173),a(174),a(120)),l=a(26),h=a(58),d=a.n(h),u=a(121),b=a(146),p=a(79),j=a(80),m=a(165),O=a(160),g=a(66),f=a(275),y=a(90),w=a(274),v=a(59),x=a.n(v),S=a(154),C=a(276),N=a(273),z=a(89),k=a(56),R=a(16),D=Object(k.b)("store")(Object(k.c)((function(e){var t=e.store,a=t.schemas[e.tableName],s=void 0===a?void 0:a.version;if(Object(n.useEffect)((function(){t.downloadSchema(e.tableName)}),[e.tableName,s]),void 0===a)return null;for(var i=[],c=function(){var e=o[r],t=Object(R.jsx)(C.b.Item,{children:Object(R.jsxs)("div",{children:[Object(R.jsx)(y.a,{checked:e.visibility,onClick:function(t){e.setVisibility(t.target.checked)},children:"show"}),Object(R.jsx)(N.a,{type:"vertical"}),Object(R.jsx)(f.a.Text,{strong:!0,style:{width:100},ellipsis:{tooltip:e.name},children:e.name}),Object(R.jsx)(N.a,{type:"vertical"}),Object(R.jsxs)(z.a,{value:e.type,className:"ml-4",children:[Object(R.jsx)(z.a.Option,{value:"auto",children:"auto"}),Object(R.jsx)(z.a.Option,{value:"string",children:"string"}),Object(R.jsx)(z.a.Option,{value:"number",children:"number"})]})]})},e.name);i.push(t)},r=0,o=Object.values(a.columns);r<o.length;r++)c();return Object(R.jsxs)("div",{className:e.show?"":"hide",children:[Object(R.jsx)(C.b,{bordered:!0,children:i}),Object(R.jsx)(g.a,{type:"primary",className:"mt-8",onClick:function(){return a.save()},disabled:!a.hasChanged,children:"Save"})]})}))),T=Object(k.b)("store")(s=Object(k.c)(s=function(e){Object(m.a)(a,e);var t=Object(O.a)(a);function a(){var e;Object(p.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={records:[],antdColumns:[],loading:!0,showDeleted:!1,showSchema:!1,descending:!0,total:0,pageNo:1,pageSize:10,selectedRows:[]},e.componentDidMount=function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo)},e.componentDidUpdate=function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo)},e.reload=function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo,Date.now())},e.deleteRecords=function(t,a){e.setState({loading:!0}),x.a.post("/api/v1/runs/delete",{run_ids:t,is_permanent:a}).then(e.reload)},e.onSelectRows=function(t){e.setState({selectedRows:t})},e.restoreSelectedRows=function(){e.setState({loading:!0}),x.a.post("/api/v1/runs/restore",{run_ids:e.state.selectedRows}).then(e.reload)},e.updatePagination=function(t){e.setState({pageNo:t.current,pageSize:t.pageSize})},e.updateData=Object(S.a)(function(){var t=Object(b.a)(d.a.mark((function t(a,s,n,c,r,o){var l,h,b,p,j,m,O,f,y,w;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,x.a.get("/api/v1/tables",{params:{table:a}});case 3:return t.sent,t.next=6,x.a.get("/api/v1/runs",{params:{table:a,limit:c,offset:(r-1)*c,include_deleted:s?"true":"false",order:n?"desc":"asc"}});case 6:l=t.sent,h=l.data.total,b=l.data.records,p={},j=Object(u.a)(b);try{for(j.s();!(m=j.n()).done;)for(O=m.value,f=0,y=Object.keys(O);f<y.length;f++)w=y[f],void 0===p[w]&&(p[w]={title:w.toUpperCase(),dataIndex:w,key:w,render:function(e,t){return"number"===typeof e?parseFloat(e.toFixed(4)):e}})}catch(o){j.e(o)}finally{j.f()}(p=Object.values(p)).length>0&&p.push({title:"ACTIONS",key:"__action_58172__",render:function(t,a){return Object(R.jsxs)(i.a.Fragment,{children:[Object(R.jsx)(g.a,{type:"primary",danger:!0,onClick:function(){return e.deleteRecords([a.id])},children:"Delete"}),e.state.showDeleted&&a.deleted?Object(R.jsx)(g.a,{type:"primary",className:"ml-4",children:"Restore"}):null]})}}),e.setState({loading:!1,records:b,antdColumns:p,total:h,selectedRows:[]});case 15:case"end":return t.stop()}}),t)})));return function(e,a,s,n,i,c){return t.apply(this,arguments)}}()),e}return Object(j.a)(a,[{key:"tableName",get:function(){return this.props.match.params.tableName}},{key:"render",value:function(){var e=this,t=this.props.store.schemas[this.tableName],a=[];if(void 0!==t){var s,n=Object(u.a)(this.state.antdColumns);try{for(n.s();!(s=n.n()).done;){var c=s.value,r=t.columns[c.dataIndex];void 0!==r&&!1===r.visibility||a.push(c)}}catch(o){n.e(o)}finally{n.f()}}else a=this.state.antdColumns;return Object(R.jsxs)(i.a.Fragment,{children:[Object(R.jsxs)("div",{className:"mt-8 mb-8",children:[Object(R.jsx)(f.a.Text,{strong:!0,keyboard:!0,children:"SEARCH"}),Object(R.jsx)(y.a,{className:"ml-12",onChange:function(t){return e.setState({showDeleted:t.target.checked})},checked:this.state.showDeleted,children:"Show deleted runs"}),Object(R.jsx)(y.a,{onChange:function(t){return e.setState({descending:t.target.checked})},checked:this.state.descending,children:"Sort Descending"})]}),Object(R.jsxs)("div",{className:"mt-8 mb-8",children:[Object(R.jsx)(f.a.Text,{strong:!0,type:"secondary",children:"ACTIONS"}),Object(R.jsx)(g.a,{className:"ml-16",size:"small",onClick:function(){return e.setState({showSchema:!e.state.showSchema})},children:this.state.showSchema?"Hide settings":"Show settings"}),Object(R.jsx)(g.a,{className:"ml-4",size:"small",onClick:this.reload,children:"Reload"}),Object(R.jsx)(g.a,{className:"ml-4",type:"primary",size:"small",onClick:function(){return e.restoreSelectedRows()},disabled:0==this.state.selectedRows.length,children:"Restore"}),Object(R.jsx)(g.a,{className:"ml-4",type:"primary",danger:!0,size:"small",onClick:function(){return e.deleteRecords(e.state.selectedRows,!0)},disabled:0==this.state.selectedRows.length,children:"Delete Permanently"}),Object(R.jsx)(g.a,{className:"ml-4",danger:!0,size:"small",onClick:function(){return e.deleteRecords(e.state.selectedRows)},disabled:0==this.state.selectedRows.length,children:"Delete"}),this.state.selectedRows.length>0?Object(R.jsxs)(f.a.Text,{strong:!0,type:"danger",className:"ml-4",children:[this.state.selectedRows.length," rows selected"]}):null,Object(R.jsx)("div",{className:"mt-8 mb-8",children:Object(R.jsx)(D,{show:this.state.showSchema,tableName:this.tableName})})]}),Object(R.jsx)(w.a,{size:"small",dataSource:this.state.records.slice(0,this.state.pageSize),rowKey:"id",pagination:{position:["topLeft","bottomLeft"],total:this.state.total,current:this.state.pageNo,pageSize:this.state.pageSize,pageSizeOptions:["5","10","20","50","100","10000"],showSizeChanger:!0,showTotal:function(e){return"Total ".concat(e," items")}},columns:a,loading:this.state.loading,onChange:this.updatePagination,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},rowSelection:{onChange:this.onSelectRows}})]})}}]),a}(i.a.Component))||s)||s,F=Object(l.f)(T);function _(){return Object(R.jsx)("div",{children:Object(R.jsx)(o.a,{children:Object(R.jsx)("div",{children:Object(R.jsxs)(l.c,{children:[Object(R.jsx)(l.a,{path:"/exps/:tableName",children:Object(R.jsx)(F,{})}),Object(R.jsx)(l.a,{path:"/",children:Object(R.jsx)("span",{style:{fontSize:"2em"},children:"The server is live"})})]})})})})}var P,I,A,L,V,E,B,H,J,U,K,M,q,G,Q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,277)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),i(e),c(e)}))},W=a(161),X=a(44),Y=a(32),Z=(a(270),a(11)),$=(P=function(){function e(t,a,s,n,i){Object(p.a)(this,e),Object(X.a)(this,"name",I,this),Object(X.a)(this,"count",A,this),Object(X.a)(this,"visibility",L,this),Object(X.a)(this,"type",V,this),Object(X.a)(this,"format",E,this),Object(X.a)(this,"hasChanged",B,this),Object(Z.o)(this),this.name=t,this.count=a,this.visibility=s,this.type=n,this.format=i,this.hasChanged=!1}return Object(j.a)(e,[{key:"setVisibility",value:function(e){this.visibility=e,this.hasChanged=!0}}]),e}(),I=Object(Y.a)(P.prototype,"name",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(Y.a)(P.prototype,"count",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Object(Y.a)(P.prototype,"visibility",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(Y.a)(P.prototype,"type",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(Y.a)(P.prototype,"format",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Object(Y.a)(P.prototype,"hasChanged",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Y.a)(P.prototype,"setVisibility",[Z.f],Object.getOwnPropertyDescriptor(P.prototype,"setVisibility"),P.prototype),P),ee=(H=function(){function e(t,a,s){Object(p.a)(this,e),Object(X.a)(this,"name",J,this),Object(X.a)(this,"version",U,this),Object(X.a)(this,"columns",K,this),this.save=Object(Z.j)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/v1/tables/".concat(this.name),{columns:this.columns});case 2:for(t=0,a=Object.values(this.columns);t<a.length;t++)a[t].hasChanged=!1;case 3:case"end":return e.stop()}}),e,this)}))),Object(Z.o)(this),this.name=t,this.version=a,this.columns=s}return Object(j.a)(e,[{key:"hasChanged",get:function(){return Object.values(this.columns).some((function(e){return e.hasChanged}))}}]),e}(),J=Object(Y.a)(H.prototype,"name",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Object(Y.a)(H.prototype,"version",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(Y.a)(H.prototype,"columns",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Y.a)(H.prototype,"hasChanged",[Z.g],Object.getOwnPropertyDescriptor(H.prototype,"hasChanged"),H.prototype),H),te=new(M=function(){function e(){Object(p.a)(this,e),Object(X.a)(this,"schemas",q,this),Object(X.a)(this,"version",G,this),this.downloadSchema=Object(Z.j)(d.a.mark((function e(t){var a,s,n,i,c,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/v1/tables/".concat(t));case 2:for(a=e.sent,s={},n=0,i=Object.entries(a.data.columns);n<i.length;n++)c=Object(W.a)(i[n],2),r=c[0],o=c[1],s[r]=new $(r,o.count,o.visibility,o.type,o.format);this.setSchema(new ee(t,a.data.version,s));case 6:case"end":return e.stop()}}),e,this)}))),Object(Z.o)(this)}return Object(j.a)(e,[{key:"setSchema",value:function(e){this.schemas[e.name]=e}}]),e}(),q=Object(Y.a)(M.prototype,"schemas",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),G=Object(Y.a)(M.prototype,"version",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(Y.a)(M.prototype,"setSchema",[Z.f],Object.getOwnPropertyDescriptor(M.prototype,"setSchema"),M.prototype),M);r.a.render(Object(R.jsx)(k.a,{store:te,children:Object(R.jsx)(_,{})}),document.getElementById("root")),Q()}},[[271,1,2]]]);
//# sourceMappingURL=main.a9a8508f.chunk.js.map