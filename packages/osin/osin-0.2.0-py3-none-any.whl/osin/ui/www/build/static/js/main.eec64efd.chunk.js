(this.webpackJsonpwww=this.webpackJsonpwww||[]).push([[0],{173:function(e,t,a){},174:function(e,t,a){},271:function(e,t,a){"use strict";a.r(t);var s,n=a(0),i=a.n(n),c=a(24),r=a.n(c),o=(a(173),a(174),a(120)),l=a(26),h=a(59),d=a.n(h),u=a(121),b=a(146),p=a(79),j=a(80),m=a(165),O=a(160),g=a(66),f=a(275),w=a(90),y=a(274),v=a(51),x=a.n(v),S=a(154),N=a(276),C=a(273),z=a(89),k=a(57),D=a(16),R=Object(k.b)("store")(Object(k.c)((function(e){var t=e.store,a=t.schemas[e.tableName],s=void 0===a?void 0:a.version;if(Object(n.useEffect)((function(){t.downloadSchema(e.tableName)}),[e.tableName,s]),void 0===a)return null;for(var i=[],c=function(){var e=o[r],t=Object(D.jsx)(N.b.Item,{children:Object(D.jsxs)("div",{children:[Object(D.jsx)(w.a,{checked:e.visibility,onClick:function(t){e.setVisibility(t.target.checked)},children:"show"}),Object(D.jsx)(C.a,{type:"vertical"}),Object(D.jsx)(f.a.Text,{strong:!0,style:{width:100},ellipsis:{tooltip:e.name},children:e.name}),Object(D.jsx)(C.a,{type:"vertical"}),Object(D.jsxs)(z.a,{value:e.type,className:"ml-4",children:[Object(D.jsx)(z.a.Option,{value:"auto",children:"auto"}),Object(D.jsx)(z.a.Option,{value:"string",children:"string"}),Object(D.jsx)(z.a.Option,{value:"number",children:"number"})]})]})},e.name);i.push(t)},r=0,o=Object.values(a.columns);r<o.length;r++)c();return Object(D.jsxs)("div",{className:e.show?"":"hide",children:[Object(D.jsx)(N.b,{bordered:!0,children:i}),Object(D.jsx)(g.a,{type:"primary",className:"mt-8",onClick:function(){return a.save()},disabled:!a.hasChanged,children:"Save"})]})}))),T=Object(k.b)("store")(s=Object(k.c)(s=function(e){Object(m.a)(a,e);var t=Object(O.a)(a);function a(){var e;Object(p.a)(this,a);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={records:[],antdColumns:[],loading:!0,showDeleted:!1,showSchema:!1,descending:!0,total:0,pageNo:1,pageSize:10,selectedRows:[]},e.componentDidMount=function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo)},e.componentDidUpdate=function(t){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo)},e.deleteRecord=function(t){e.setState({loading:!0}),x.a.delete("/api/v1/runs/".concat(t)).then((function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo,t)}))},e.onSelectRows=function(t){e.setState({selectedRows:t})},e.restoreSelectedRows=function(){x.a.post("/api/v1/runs/restore",{run_ids:e.state.selectedRows}).then((function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo,JSON.stringify(e.state.selectedRows))}))},e.deleteSelectedRows=function(){x.a.post("/api/v1/runs/delete",{run_ids:e.state.selectedRows}).then((function(){e.updateData(e.tableName,e.state.showDeleted,e.state.descending,e.state.pageSize,e.state.pageNo,JSON.stringify(e.state.selectedRows))}))},e.updatePagination=function(t){e.setState({pageNo:t.current,pageSize:t.pageSize})},e.updateData=Object(S.a)(function(){var t=Object(b.a)(d.a.mark((function t(a,s,n,c,r,o){var l,h,b,p,j,m,O,f,w,y;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.next=3,x.a.get("/api/v1/tables",{params:{table:a}});case 3:return t.sent,t.next=6,x.a.get("/api/v1/runs",{params:{table:a,limit:c,offset:(r-1)*c,include_deleted:s?"true":"false",order:n?"desc":"asc"}});case 6:l=t.sent,h=l.data.total,b=l.data.records,p={},j=Object(u.a)(b);try{for(j.s();!(m=j.n()).done;)for(O=m.value,f=0,w=Object.keys(O);f<w.length;f++)y=w[f],void 0===p[y]&&(p[y]={title:y.toUpperCase(),dataIndex:y,key:y})}catch(o){j.e(o)}finally{j.f()}(p=Object.values(p)).length>0&&p.push({title:"ACTIONS",key:"__action_58172__",render:function(t,a){return Object(D.jsxs)(i.a.Fragment,{children:[Object(D.jsx)(g.a,{type:"primary",danger:!0,onClick:function(){return e.deleteRecord(a.id)},children:"Delete"}),e.state.showDeleted&&a.deleted?Object(D.jsx)(g.a,{type:"primary",className:"ml-4",children:"Restore"}):null]})}}),e.setState({loading:!1,records:b,antdColumns:p,total:h,selectedRows:[]});case 15:case"end":return t.stop()}}),t)})));return function(e,a,s,n,i,c){return t.apply(this,arguments)}}()),e}return Object(j.a)(a,[{key:"tableName",get:function(){return this.props.match.params.tableName}},{key:"render",value:function(){var e=this,t=this.props.store.schemas[this.tableName],a=[];if(void 0!==t){var s,n=Object(u.a)(this.state.antdColumns);try{for(n.s();!(s=n.n()).done;){var c=s.value,r=t.columns[c.dataIndex];void 0!==r&&!1===r.visibility||a.push(c)}}catch(o){n.e(o)}finally{n.f()}}else a=this.state.antdColumns;return Object(D.jsxs)(i.a.Fragment,{children:[Object(D.jsxs)("div",{className:"mt-8 mb-8",children:[Object(D.jsx)(f.a.Text,{strong:!0,keyboard:!0,children:"SEARCH"}),Object(D.jsx)(w.a,{className:"ml-12",onChange:function(t){return e.setState({showDeleted:t.target.checked})},checked:this.state.showDeleted,children:"Show deleted runs"}),Object(D.jsx)(w.a,{onChange:function(t){return e.setState({descending:t.target.checked})},checked:this.state.descending,children:"Sort Descending"})]}),Object(D.jsxs)("div",{className:"mt-8 mb-8",children:[Object(D.jsx)(f.a.Text,{strong:!0,type:"secondary",children:"ACTIONS"}),Object(D.jsx)(g.a,{className:"ml-16",size:"small",onClick:function(){return e.setState({showSchema:!e.state.showSchema})},children:this.state.showSchema?"Hide settings":"Show settings"}),Object(D.jsx)(g.a,{className:"ml-4",type:"primary",size:"small",onClick:function(){return e.restoreSelectedRows()},disabled:0==this.state.selectedRows.length,children:"Restore"}),Object(D.jsx)(g.a,{className:"ml-4",type:"primary",danger:!0,size:"small",onClick:function(){return e.deleteSelectedRows()},disabled:0==this.state.selectedRows.length,children:"Delete"}),this.state.selectedRows.length>0?Object(D.jsxs)(f.a.Text,{strong:!0,type:"danger",className:"ml-4",children:[this.state.selectedRows.length," rows selected"]}):null,Object(D.jsx)("div",{className:"mt-8 mb-8",children:Object(D.jsx)(R,{show:this.state.showSchema,tableName:this.tableName})})]}),Object(D.jsx)(y.a,{size:"small",dataSource:this.state.records.slice(0,this.state.pageSize),rowKey:"id",pagination:{position:["topLeft","bottomLeft"],total:this.state.total,current:this.state.pageNo,pageSize:this.state.pageSize,pageSizeOptions:["5","10","20","50","100","10000"],showSizeChanger:!0,showTotal:function(e){return"Total ".concat(e," items")}},columns:a,loading:this.state.loading,onChange:this.updatePagination,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},rowSelection:{onChange:this.onSelectRows}})]})}}]),a}(i.a.Component))||s)||s,_=Object(l.f)(T);function F(){return Object(D.jsx)("div",{children:Object(D.jsx)(o.a,{children:Object(D.jsx)("div",{children:Object(D.jsxs)(l.c,{children:[Object(D.jsx)(l.a,{path:"/exps/:tableName",children:Object(D.jsx)(_,{})}),Object(D.jsx)(l.a,{path:"/",children:Object(D.jsx)("span",{style:{fontSize:"2em"},children:"The server is live"})})]})})})})}var I,P,A,J,L,V,E,B,H,U,K,M,q,G,Q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,277)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),i(e),c(e)}))},W=a(161),X=a(44),Y=a(32),Z=(a(270),a(11)),$=(I=function(){function e(t,a,s,n,i){Object(p.a)(this,e),Object(X.a)(this,"name",P,this),Object(X.a)(this,"count",A,this),Object(X.a)(this,"visibility",J,this),Object(X.a)(this,"type",L,this),Object(X.a)(this,"format",V,this),Object(X.a)(this,"hasChanged",E,this),Object(Z.o)(this),this.name=t,this.count=a,this.visibility=s,this.type=n,this.format=i,this.hasChanged=!1}return Object(j.a)(e,[{key:"setVisibility",value:function(e){this.visibility=e,this.hasChanged=!0}}]),e}(),P=Object(Y.a)(I.prototype,"name",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(Y.a)(I.prototype,"count",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(Y.a)(I.prototype,"visibility",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Object(Y.a)(I.prototype,"type",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(Y.a)(I.prototype,"format",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(Y.a)(I.prototype,"hasChanged",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Y.a)(I.prototype,"setVisibility",[Z.f],Object.getOwnPropertyDescriptor(I.prototype,"setVisibility"),I.prototype),I),ee=(B=function(){function e(t,a,s){Object(p.a)(this,e),Object(X.a)(this,"name",H,this),Object(X.a)(this,"version",U,this),Object(X.a)(this,"columns",K,this),this.save=Object(Z.j)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/v1/tables/".concat(this.name),{columns:this.columns});case 2:for(t=0,a=Object.values(this.columns);t<a.length;t++)a[t].hasChanged=!1;case 3:case"end":return e.stop()}}),e,this)}))),Object(Z.o)(this),this.name=t,this.version=a,this.columns=s}return Object(j.a)(e,[{key:"hasChanged",get:function(){return Object.values(this.columns).some((function(e){return e.hasChanged}))}}]),e}(),H=Object(Y.a)(B.prototype,"name",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Object(Y.a)(B.prototype,"version",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(Y.a)(B.prototype,"columns",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(Y.a)(B.prototype,"hasChanged",[Z.g],Object.getOwnPropertyDescriptor(B.prototype,"hasChanged"),B.prototype),B),te=new(M=function(){function e(){Object(p.a)(this,e),Object(X.a)(this,"schemas",q,this),Object(X.a)(this,"version",G,this),this.downloadSchema=Object(Z.j)(d.a.mark((function e(t){var a,s,n,i,c,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/v1/tables/".concat(t));case 2:for(a=e.sent,s={},n=0,i=Object.entries(a.data.columns);n<i.length;n++)c=Object(W.a)(i[n],2),r=c[0],o=c[1],s[r]=new $(r,o.count,o.visibility,o.type,o.format);this.setSchema(new ee(t,a.data.version,s));case 6:case"end":return e.stop()}}),e,this)}))),Object(Z.o)(this)}return Object(j.a)(e,[{key:"setSchema",value:function(e){this.schemas[e.name]=e}}]),e}(),q=Object(Y.a)(M.prototype,"schemas",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),G=Object(Y.a)(M.prototype,"version",[Z.p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(Y.a)(M.prototype,"setSchema",[Z.f],Object.getOwnPropertyDescriptor(M.prototype,"setSchema"),M.prototype),M);r.a.render(Object(D.jsx)(k.a,{store:te,children:Object(D.jsx)(F,{})}),document.getElementById("root")),Q()}},[[271,1,2]]]);
//# sourceMappingURL=main.eec64efd.chunk.js.map