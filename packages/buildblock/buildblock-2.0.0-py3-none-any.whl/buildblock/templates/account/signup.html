{% extends "account/base.html" %}
{% load static i18n widget_tweaks %}
{% load base_tag crispy_forms_tags %}

{% block content %}
<div class="col-lg-5">
    <div class="card">
        <div class="card-header pt-4 pb-4 text-center bg-primary">
            <a href="{% url 'home' %}">
                <span><img src="{% static 'landing/images/logo/logo_w_h36.png' %}" alt="" height="24" id="side-main-logo"></span>
            </a>
        </div>
        <div class="card-body p-4">
            <div class="text-center w-75 m-auto">
                <h4 class="text-dark-50 text-center mt-0 font-weight-bold">{% trans 'Sign Up' %}</h4>
                <p class="text-muted mb-4">{% trans "Don't have an account? Create your account, it takes less than a minute" %}</p>
            </div>

            <form class="account_form" id="signup_form" method="post" action="{% url 'account_signup' %}">
                {% csrf_token %}
                {% for hidden_field in form.hidden_fields %}
                {{ hidden_field }}
                {% endfor %}

                {% if form.non_field_errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.non_field_errors %}
                  {{ error }}
                  {% endfor %}
                </div>
                {% endif %}

                <div class="form-group">
                    {% include "account/signup_form.html" with field=form.email %}
                </div>
                <div class="form-group">
                    {% include "account/signup_form.html" with field=form.password1 %}
                </div>
                <div class="form-group">
                    {% include "account/signup_form.html" with field=form.password2 %}
                </div>

                <div class="divider"></div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        {% include "account/signup_form.html" with field=form.first_name %}
                    </div>
                    <div class="form-group col-md-6">
                        {% include "account/signup_form.html" with field=form.last_name %}
                    </div>
                </div>

                <div class="form-group">
                    {% include "account/signup_form.html" with field=form.nationality %}
                </div>

                <div class="form-group">
                    {% include "account/signup_form.html" with field=form.phone_number %}
                </div>

                <div class="form-group">
                    <div class="custom-control custom-checkbox">
                        <div>
                          <input type="checkbox"
                                 class="custom-control-input {% if form.agree_terms.errors|length > 0 %}is-invalid{% endif %}"
                                 id="id_agree_terms"
                                 name="agree_terms">
                          <label class="custom-control-label" for="id_agree_terms">
                              <span class="hidden_ko">I accept</span>
                              <a class="text-muted" data-toggle="modal" data-target="#agreement_tos">{% trans "Terms of Service" %}</a>
                              & <a class="text-muted" data-toggle="modal" data-target="#agreement_pp">{% trans 'Privacy Policy' %}</a>
                              <span class="hidden_en">동의</span>
                          </label>
                          {% for error in form.agree_terms.errors %}
                          <div class="invalid-feedback">{{ error }}</div>
                          {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="form-group mb-0 text-center">
                    <button class="btn btn-primary btn-block" type="submit"> {% trans "Sign Up" %} </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}


{% block more_action %}
<div class="col-10 text-center">
    <p class="text-muted">{% trans "Already have an account?" %} <a href="{% url 'account_login' %}" class="text-muted ml-1"><b>{% trans "Sign in" %}</b></a></p>
</div>
{% endblock more_action %}


{% block modal %}
{% get_current_language as LANGUAGE_CODE %}
<!--Term of Service-->
{% get_agreement_by_type_language service_type='management' agreement_type='tos' language=LANGUAGE_CODE as AGREEMENTS_TOS %}
<div class="modal fade" id="agreement_tos" tabindex="-1" role="dialog" aria-labelledby="tosModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="tosModalCenterTitle">{{AGREEMENTS_TOS.title}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {{AGREEMENTS_TOS.content|safe}}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal"> {% trans "Close" %} </button>
            </div>
        </div>
    </div>
</div>

<!--Privacy Policy-->
{% get_agreement_by_type_language service_type='management' agreement_type='pp' language=LANGUAGE_CODE as AGREEMENTS_PP %}
<div class="modal fade" id="agreement_pp" tabindex="-1" role="dialog" aria-labelledby="ppModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ppModalCenterTitle">{{AGREEMENTS_PP.title}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {{AGREEMENTS_PP.content|safe}}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal"> {% trans "Close" %} </button>
            </div>
        </div>
    </div>
</div>
{% endblock modal %}
