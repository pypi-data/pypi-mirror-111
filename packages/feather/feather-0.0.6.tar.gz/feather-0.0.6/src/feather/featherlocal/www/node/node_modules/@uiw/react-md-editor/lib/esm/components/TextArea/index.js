import _extends from "@babel/runtime/helpers/extends";
import _objectSpread from "@babel/runtime/helpers/objectSpread2";
import _objectWithoutProperties from "@babel/runtime/helpers/objectWithoutProperties";
var _excluded = ["prefixCls", "className", "onScroll", "renderTextarea"];
import React, { useEffect, Fragment, useContext } from 'react';
import { EditorContext } from '../../Context';
import shortcuts from './shortcuts';
import Markdown from './Markdown';
import Textarea from './Textarea';
import { TextAreaCommandOrchestrator } from '../../commands';
import "./index.css";
export default function TextArea(props) {
  var _ref = props || {},
      prefixCls = _ref.prefixCls,
      className = _ref.className,
      onScroll = _ref.onScroll,
      renderTextarea = _ref.renderTextarea,
      otherProps = _objectWithoutProperties(_ref, _excluded);

  var _useContext = useContext(EditorContext),
      markdown = _useContext.markdown,
      scrollTop = _useContext.scrollTop,
      commands = _useContext.commands,
      extraCommands = _useContext.extraCommands,
      onChange = _useContext.onChange,
      dispatch = _useContext.dispatch;

  var textRef = React.useRef(null);
  var executeRef = React.useRef();
  var warp = /*#__PURE__*/React.createRef();
  useEffect(function () {
    var state = {};

    if (warp.current) {
      state.textareaWarp = warp.current || undefined;
      warp.current.scrollTop = scrollTop || 0;
    }

    if (dispatch) {
      dispatch(_objectSpread({}, state));
    } // eslint-disable-next-line react-hooks/exhaustive-deps

  }, []);
  useEffect(function () {
    if (textRef.current && dispatch) {
      var _commandOrchestrator = new TextAreaCommandOrchestrator(textRef.current);

      executeRef.current = _commandOrchestrator;
      dispatch({
        textarea: textRef.current,
        commandOrchestrator: _commandOrchestrator
      });
    } // eslint-disable-next-line react-hooks/exhaustive-deps

  }, []);
  return /*#__PURE__*/React.createElement("div", {
    ref: warp,
    className: "".concat(prefixCls, "-aree ").concat(className || ''),
    onScroll: onScroll
  }, /*#__PURE__*/React.createElement("div", {
    className: "".concat(prefixCls, "-text")
  }, renderTextarea ? /*#__PURE__*/React.cloneElement(renderTextarea(_objectSpread(_objectSpread({}, otherProps), {}, {
    value: markdown,
    autoComplete: 'off',
    autoCorrect: 'off',
    spellCheck: 'false',
    autoCapitalize: 'off',
    className: "".concat(prefixCls, "-text-input"),
    style: {
      WebkitTextFillColor: 'inherit',
      overflow: 'auto'
    }
  }), {
    dispatch: dispatch,
    onChange: onChange,
    shortcuts: shortcuts,
    useContext: {
      commands: commands,
      extraCommands: extraCommands,
      commandOrchestrator: executeRef.current
    }
  }), {
    ref: textRef
  }) : /*#__PURE__*/React.createElement(Fragment, null, /*#__PURE__*/React.createElement(Markdown, {
    prefixCls: prefixCls
  }), /*#__PURE__*/React.createElement(Textarea, _extends({
    prefixCls: prefixCls
  }, otherProps)))));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1RleHRBcmVhL2luZGV4LnRzeCJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsIkZyYWdtZW50IiwidXNlQ29udGV4dCIsIkVkaXRvckNvbnRleHQiLCJzaG9ydGN1dHMiLCJNYXJrZG93biIsIlRleHRhcmVhIiwiVGV4dEFyZWFDb21tYW5kT3JjaGVzdHJhdG9yIiwiVGV4dEFyZWEiLCJwcm9wcyIsInByZWZpeENscyIsImNsYXNzTmFtZSIsIm9uU2Nyb2xsIiwicmVuZGVyVGV4dGFyZWEiLCJvdGhlclByb3BzIiwibWFya2Rvd24iLCJzY3JvbGxUb3AiLCJjb21tYW5kcyIsImV4dHJhQ29tbWFuZHMiLCJvbkNoYW5nZSIsImRpc3BhdGNoIiwidGV4dFJlZiIsInVzZVJlZiIsImV4ZWN1dGVSZWYiLCJ3YXJwIiwiY3JlYXRlUmVmIiwic3RhdGUiLCJjdXJyZW50IiwidGV4dGFyZWFXYXJwIiwidW5kZWZpbmVkIiwiY29tbWFuZE9yY2hlc3RyYXRvciIsInRleHRhcmVhIiwiY2xvbmVFbGVtZW50IiwidmFsdWUiLCJhdXRvQ29tcGxldGUiLCJhdXRvQ29ycmVjdCIsInNwZWxsQ2hlY2siLCJhdXRvQ2FwaXRhbGl6ZSIsInN0eWxlIiwiV2Via2l0VGV4dEZpbGxDb2xvciIsIm92ZXJmbG93IiwicmVmIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBT0EsS0FBUCxJQUFnQkMsU0FBaEIsRUFBMkJDLFFBQTNCLEVBQXFDQyxVQUFyQyxRQUF1RCxPQUF2RDtBQUNBLFNBQVNDLGFBQVQsUUFBaUUsZUFBakU7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLGFBQXRCO0FBQ0EsT0FBT0MsUUFBUCxNQUFxQixZQUFyQjtBQUNBLE9BQU9DLFFBQVAsTUFBcUIsWUFBckI7QUFHQSxTQUFTQywyQkFBVCxRQUFzRCxnQkFBdEQ7QUFDQTtBQW1DQSxlQUFlLFNBQVNDLFFBQVQsQ0FBa0JDLEtBQWxCLEVBQXlDO0FBQ3RELGFB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QyxNQUFBQSxhQUFhLEVBQWJBLGFBQVo7QUFBMkJZLE1BQUFBLG1CQUFtQixFQUFFUCxVQUFVLENBQUNJO0FBQTNEO0FBSmQsR0FkWSxDQURoQixFQXNCRTtBQUNFYyxJQUFBQSxHQUFHLEVBQUVwQjtBQURQLEdBdEJGLENBRGEsZ0JBNEJiLG9CQUFDLFFBQUQscUJBQ0Usb0JBQUMsUUFBRDtBQUFVLElBQUEsU0FBUyxFQUFFWDtBQUFyQixJQURGLGVBRUUsb0JBQUMsUUFBRDtBQUFVLElBQUEsU0FBUyxFQUFFQTtBQUFyQixLQUFvQ0ksVUFBcEMsRUFGRixDQTdCSixDQURGLENBREY7QUF1Q0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCBGcmFnbWVudCwgdXNlQ29udGV4dCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEVkaXRvckNvbnRleHQsIENvbnRleHRTdG9yZSwgRXhlY3V0ZUNvbW1hbmRTdGF0ZSB9IGZyb20gJy4uLy4uL0NvbnRleHQnO1xuaW1wb3J0IHNob3J0Y3V0cyBmcm9tICcuL3Nob3J0Y3V0cyc7XG5pbXBvcnQgTWFya2Rvd24gZnJvbSAnLi9NYXJrZG93bic7XG5pbXBvcnQgVGV4dGFyZWEgZnJvbSAnLi9UZXh0YXJlYSc7XG5pbXBvcnQgeyBJUHJvcHMgfSBmcm9tICcuLi8uLi91dGlscyc7XG5pbXBvcnQgeyBNREVkaXRvclByb3BzIH0gZnJvbSAnLi4vLi4vRWRpdG9yJztcbmltcG9ydCB7IFRleHRBcmVhQ29tbWFuZE9yY2hlc3RyYXRvciwgSUNvbW1hbmQgfSBmcm9tICcuLi8uLi9jb21tYW5kcyc7XG5pbXBvcnQgJy4vaW5kZXgubGVzcyc7XG5cbnR5cGUgUmVuZGVyVGV4dGFyZWFIYW5kbGUgPSB7XG4gIGRpc3BhdGNoOiBDb250ZXh0U3RvcmVbJ2Rpc3BhdGNoJ107XG4gIG9uQ2hhbmdlPzogTURFZGl0b3JQcm9wc1snb25DaGFuZ2UnXTtcbiAgdXNlQ29udGV4dD86IHtcbiAgICBjb21tYW5kczogQ29udGV4dFN0b3JlWydjb21tYW5kcyddO1xuICAgIGV4dHJhQ29tbWFuZHM6IENvbnRleHRTdG9yZVsnZXh0cmFDb21tYW5kcyddO1xuICAgIGNvbW1hbmRPcmNoZXN0cmF0b3I/OiBUZXh0QXJlYUNvbW1hbmRPcmNoZXN0cmF0b3I7XG4gIH07XG4gIHNob3J0Y3V0cz86IChcbiAgICBlOiBLZXlib2FyZEV2ZW50IHwgUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MVGV4dEFyZWFFbGVtZW50PixcbiAgICBjb21tYW5kczogSUNvbW1hbmRbXSxcbiAgICBjb21tYW5kT3JjaGVzdHJhdG9yPzogVGV4dEFyZWFDb21tYW5kT3JjaGVzdHJhdG9yLFxuICAgIGRpc3BhdGNoPzogUmVhY3QuRGlzcGF0Y2g8Q29udGV4dFN0b3JlPixcbiAgICBzdGF0ZT86IEV4ZWN1dGVDb21tYW5kU3RhdGUsXG4gICkgPT4gdm9pZDtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRleHRBcmVhUHJvcHNcbiAgZXh0ZW5kcyBPbWl0PFJlYWN0LlRleHRhcmVhSFRNTEF0dHJpYnV0ZXM8SFRNTFRleHRBcmVhRWxlbWVudD4sICd2YWx1ZScgfCAnb25DaGFuZ2UnIHwgJ29uU2Nyb2xsJz4sXG4gICAgSVByb3BzIHtcbiAgdmFsdWU/OiBzdHJpbmc7XG4gIG9uU2Nyb2xsPzogKGU6IFJlYWN0LlVJRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSA9PiB2b2lkO1xuICByZW5kZXJUZXh0YXJlYT86IChcbiAgICBwcm9wczogUmVhY3QuVGV4dGFyZWFIVE1MQXR0cmlidXRlczxIVE1MVGV4dEFyZWFFbGVtZW50PiB8IFJlYWN0LkhUTUxBdHRyaWJ1dGVzPEhUTUxEaXZFbGVtZW50PixcbiAgICBvcHRzOiBSZW5kZXJUZXh0YXJlYUhhbmRsZSxcbiAgKSA9PiBKU1guRWxlbWVudDtcbn1cblxuZXhwb3J0IHR5cGUgVGV4dEFyZWFSZWYgPSB7XG4gIHRleHQ/OiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICB3YXJwPzogSFRNTERpdkVsZW1lbnQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBUZXh0QXJlYShwcm9wczogSVRleHRBcmVhUHJvcHMpIHtcbiAgY29uc3QgeyBwcmVmaXhDbHMsIGNsYXNzTmFtZSwgb25TY3JvbGwsIHJlbmRlclRleHRhcmVhLCAuLi5vdGhlclByb3BzIH0gPSBwcm9wcyB8fCB7fTtcbiAgY29uc3QgeyBtYXJrZG93biwgc2Nyb2xsVG9wLCBjb21tYW5kcywgZXh0cmFDb21tYW5kcywgb25DaGFuZ2UsIGRpc3BhdGNoIH0gPSB1c2VDb250ZXh0KEVkaXRvckNvbnRleHQpO1xuICBjb25zdCB0ZXh0UmVmID0gUmVhY3QudXNlUmVmPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBleGVjdXRlUmVmID0gUmVhY3QudXNlUmVmPFRleHRBcmVhQ29tbWFuZE9yY2hlc3RyYXRvcj4oKTtcbiAgY29uc3Qgd2FycCA9IFJlYWN0LmNyZWF0ZVJlZjxIVE1MRGl2RWxlbWVudD4oKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBzdGF0ZTogQ29udGV4dFN0b3JlID0ge307XG4gICAgaWYgKHdhcnAuY3VycmVudCkge1xuICAgICAgc3RhdGUudGV4dGFyZWFXYXJwID0gd2FycC5jdXJyZW50IHx8IHVuZGVmaW5lZDtcbiAgICAgIHdhcnAuY3VycmVudC5zY3JvbGxUb3AgPSBzY3JvbGxUb3AgfHwgMDtcbiAgICB9XG4gICAgaWYgKGRpc3BhdGNoKSB7XG4gICAgICBkaXNwYXRjaCh7IC4uLnN0YXRlIH0pO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICh0ZXh0UmVmLmN1cnJlbnQgJiYgZGlzcGF0Y2gpIHtcbiAgICAgIGNvbnN0IGNvbW1hbmRPcmNoZXN0cmF0b3IgPSBuZXcgVGV4dEFyZWFDb21tYW5kT3JjaGVzdHJhdG9yKHRleHRSZWYuY3VycmVudCk7XG4gICAgICBleGVjdXRlUmVmLmN1cnJlbnQgPSBjb21tYW5kT3JjaGVzdHJhdG9yO1xuICAgICAgZGlzcGF0Y2goeyB0ZXh0YXJlYTogdGV4dFJlZi5jdXJyZW50LCBjb21tYW5kT3JjaGVzdHJhdG9yIH0pO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtdKTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgcmVmPXt3YXJwfSBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tYXJlZSAke2NsYXNzTmFtZSB8fCAnJ31gfSBvblNjcm9sbD17b25TY3JvbGx9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake3ByZWZpeENsc30tdGV4dGB9PlxuICAgICAgICB7cmVuZGVyVGV4dGFyZWEgPyAoXG4gICAgICAgICAgUmVhY3QuY2xvbmVFbGVtZW50KFxuICAgICAgICAgICAgcmVuZGVyVGV4dGFyZWEoXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAuLi5vdGhlclByb3BzLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBtYXJrZG93bixcbiAgICAgICAgICAgICAgICBhdXRvQ29tcGxldGU6ICdvZmYnLFxuICAgICAgICAgICAgICAgIGF1dG9Db3JyZWN0OiAnb2ZmJyxcbiAgICAgICAgICAgICAgICBzcGVsbENoZWNrOiAnZmFsc2UnLFxuICAgICAgICAgICAgICAgIGF1dG9DYXBpdGFsaXplOiAnb2ZmJyxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGAke3ByZWZpeENsc30tdGV4dC1pbnB1dGAsXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgIFdlYmtpdFRleHRGaWxsQ29sb3I6ICdpbmhlcml0JyxcbiAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiAnYXV0bycsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoLFxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlLFxuICAgICAgICAgICAgICAgIHNob3J0Y3V0cyxcbiAgICAgICAgICAgICAgICB1c2VDb250ZXh0OiB7IGNvbW1hbmRzLCBleHRyYUNvbW1hbmRzLCBjb21tYW5kT3JjaGVzdHJhdG9yOiBleGVjdXRlUmVmLmN1cnJlbnQgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJlZjogdGV4dFJlZixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgKVxuICAgICAgICApIDogKFxuICAgICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICAgIDxNYXJrZG93biBwcmVmaXhDbHM9e3ByZWZpeENsc30gLz5cbiAgICAgICAgICAgIDxUZXh0YXJlYSBwcmVmaXhDbHM9e3ByZWZpeENsc30gey4uLm90aGVyUHJvcHN9IC8+XG4gICAgICAgICAgPC9GcmFnbWVudD5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuIl19