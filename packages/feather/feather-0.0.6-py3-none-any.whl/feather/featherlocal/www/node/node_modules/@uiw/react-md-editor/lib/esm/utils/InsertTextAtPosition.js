/**
 * The MIT License
 * Copyright (c) 2018 Dmitriy Kubyshkin
 * Copied from https://github.com/grassator/insert-text-at-cursor
 */
var browserSupportsTextareaTextNodes;
/**
 * @param {HTMLElement} input
 * @return {boolean}
 */

function canManipulateViaTextNodes(input) {
  if (input.nodeName !== 'TEXTAREA') {
    return false;
  }

  if (typeof browserSupportsTextareaTextNodes === 'undefined') {
    var textarea = document.createElement('textarea');
    textarea.value = '1';
    browserSupportsTextareaTextNodes = !!textarea.firstChild;
  }

  return browserSupportsTextareaTextNodes;
}
/**
 * @param {HTMLTextAreaElement|HTMLInputElement} input
 * @param {string} text
 * @returns {void}
 */


export default function insertTextAtPosition(input, text) {
  // Most of the used APIs only work with the field selected
  input.focus(); // IE 8-10

  if (document.selection) {
    var ieRange = document.selection.createRange();
    ieRange.text = text; // Move cursor after the inserted text

    ieRange.collapse(false
    /* to the end */
    );
    ieRange.select();
    return;
  } // Webkit + Edge


  var isSuccess = document.execCommand('insertText', false, text);

  if (!isSuccess) {
    var start = input.selectionStart;
    var end = input.selectionEnd; // Firefox (non-standard method)

    if (typeof input.setRangeText === 'function') {
      input.setRangeText(text);
    } else {
      // To make a change we just need a Range, not a Selection
      var range = document.createRange();
      var textNode = document.createTextNode(text);

      if (canManipulateViaTextNodes(input)) {
        var node = input.firstChild; // If textarea is empty, just insert the text

        if (!node) {
          input.appendChild(textNode);
        } else {
          // Otherwise we need to find a nodes for start and end
          var offset = 0;
          var startNode = null;
          var endNode = null;

          while (node && (startNode === null || endNode === null)) {
            var nodeLength = node.nodeValue.length; // if start of the selection falls into current node

            if (start >= offset && start <= offset + nodeLength) {
              range.setStart(startNode = node, start - offset);
            } // if end of the selection falls into current node


            if (end >= offset && end <= offset + nodeLength) {
              range.setEnd(endNode = node, end - offset);
            }

            offset += nodeLength;
            node = node.nextSibling;
          } // If there is some text selected, remove it as we should replace it


          if (start !== end) {
            range.deleteContents();
          }
        }
      } // If the node is a textarea and the range doesn't span outside the element
      //
      // Get the commonAncestorContainer of the selected range and test its type
      // If the node is of type `#text` it means that we're still working with text nodes within our textarea element
      // otherwise, if it's of type `#document` for example it means our selection spans outside the textarea.


      if (canManipulateViaTextNodes(input) && range.commonAncestorContainer.nodeName === '#text') {
        // Finally insert a new node. The browser will automatically split start and end nodes into two if necessary
        range.insertNode(textNode);
      } else {
        // If the node is not a textarea or the range spans outside a textarea the only way is to replace the whole value
        var value = input.value;
        input.value = value.slice(0, start) + text + value.slice(end);
      }
    } // Correct the cursor position to be at the end of the insertion


    input.setSelectionRange(start + text.length, start + text.length); // Notify any possible listeners of the change

    var e = document.createEvent('UIEvent');
    e.initEvent('input', true, false);
    input.dispatchEvent(e);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9JbnNlcnRUZXh0QXRQb3NpdGlvbi50cyJdLCJuYW1lcyI6WyJicm93c2VyU3VwcG9ydHNUZXh0YXJlYVRleHROb2RlcyIsImNhbk1hbmlwdWxhdGVWaWFUZXh0Tm9kZXMiLCJpbnB1dCIsIm5vZGVOYW1lIiwidGV4dGFyZWEiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ2YWx1ZSIsImZpcnN0Q2hpbGQiLCJpbnNlcnRUZXh0QXRQb3NpdGlvbiIsInRleHQiLCJmb2N1cyIsInNlbGVjdGlvbiIsImllUmFuZ2UiLCJjcmVhdGVSYW5nZSIsImNvbGxhcHNlIiwic2VsZWN0IiwiaXNTdWNjZXNzIiwiZXhlY0NvbW1hbmQiLCJzdGFydCIsInNlbGVjdGlvblN0YXJ0IiwiZW5kIiwic2VsZWN0aW9uRW5kIiwic2V0UmFuZ2VUZXh0IiwicmFuZ2UiLCJ0ZXh0Tm9kZSIsImNyZWF0ZVRleHROb2RlIiwibm9kZSIsImFwcGVuZENoaWxkIiwib2Zmc2V0Iiwic3RhcnROb2RlIiwiZW5kTm9kZSIsIm5vZGVMZW5ndGgiLCJub2RlVmFsdWUiLCJsZW5ndGgiLCJzZXRTdGFydCIsInNldEVuZCIsIm5leHRTaWJsaW5nIiwiZGVsZXRlQ29udGVudHMiLCJjb21tb25BbmNlc3RvckNvbnRhaW5lciIsImluc2VydE5vZGUiLCJzbGljZSIsInNldFNlbGVjdGlvblJhbmdlIiwiZSIsImNyZWF0ZUV2ZW50IiwiaW5pdEV2ZW50IiwiZGlzcGF0Y2hFdmVudCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLElBQUlBLGdDQUFKO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsU0FBU0MseUJBQVQsQ0FBbUNDLEtBQW5DLEVBQWtGO0FBQ2hGLE1BQUlBLEtBQUssQ0FBQ0MsUUFBTixLQUFtQixVQUF2QixFQUFtQztBQUNqQyxXQUFPLEtBQVA7QUFDRDs7QUFDRCxNQUFJLE9BQU9ILGdDQUFQLEtBQTRDLFdBQWhE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QUFLLEtBQUtFLEdBQWQsRUFBbUI7QUFDakJHLFlBQUFBLEtBQUssQ0FBQ2MsY0FBTjtBQUNEO0FBQ0Y7QUFDRixPQXZDSSxDQXlDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQSxVQUFJckMseUJBQXlCLENBQUNDLEtBQUQsQ0FBekIsSUFBb0NzQixLQUFLLENBQUNlLHVCQUFOLENBQThCcEMsUUFBOUIsS0FBMkMsT0FBbkYsRUFBNEY7QUFDMUY7QUFDQXFCLFFBQUFBLEtBQUssQ0FBQ2dCLFVBQU4sQ0FBaUJmLFFBQWpCO0FBQ0QsT0FIRCxNQUdPO0FBQ0w7QUFDQSxZQUFNbEIsS0FBSyxHQUFHTCxLQUFLLENBQUNLLEtBQXBCO0FBQ0FMLFFBQUFBLEtBQUssQ0FBQ0ssS0FBTixHQUFjQSxLQUFLLENBQUNrQyxLQUFOLENBQVksQ0FBWixFQUFldEIsS0FBZixJQUF3QlQsSUFBeEIsR0FBK0JILEtBQUssQ0FBQ2tDLEtBQU4sQ0FBWXBCLEdBQVosQ0FBN0M7QUFDRDtBQUNGLEtBNURhLENBOERkOzs7QUFDQW5CLElBQUFBLEtBQUssQ0FBQ3dDLGlCQUFOLENBQXdCdkIsS0FBSyxHQUFHVCxJQUFJLENBQUN3QixNQUFyQyxFQUE2Q2YsS0FBSyxHQUFHVCxJQUFJLENBQUN3QixNQUExRCxFQS9EYyxDQWlFZDs7QUFDQSxRQUFNUyxDQUFDLEdBQUd0QyxRQUFRLENBQUN1QyxXQUFULENBQXFCLFNBQXJCLENBQVY7QUFDQUQsSUFBQUEsQ0FBQyxDQUFDRSxTQUFGLENBQVksT0FBWixFQUFxQixJQUFyQixFQUEyQixLQUEzQjtBQUNBM0MsSUFBQUEsS0FBSyxDQUFDNEMsYUFBTixDQUFvQkgsQ0FBcEI7QUFDRDtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGUgTUlUIExpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxOCBEbWl0cml5IEt1YnlzaGtpblxuICogQ29waWVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2dyYXNzYXRvci9pbnNlcnQtdGV4dC1hdC1jdXJzb3JcbiAqL1xuXG5sZXQgYnJvd3NlclN1cHBvcnRzVGV4dGFyZWFUZXh0Tm9kZXM6IGFueTtcblxuLyoqXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBpbnB1dFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gY2FuTWFuaXB1bGF0ZVZpYVRleHROb2RlcyhpbnB1dDogSFRNTFRleHRBcmVhRWxlbWVudCB8IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgaWYgKGlucHV0Lm5vZGVOYW1lICE9PSAnVEVYVEFSRUEnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgYnJvd3NlclN1cHBvcnRzVGV4dGFyZWFUZXh0Tm9kZXMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgY29uc3QgdGV4dGFyZWE6IEhUTUxUZXh0QXJlYUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgIHRleHRhcmVhLnZhbHVlID0gJzEnO1xuICAgIGJyb3dzZXJTdXBwb3J0c1RleHRhcmVhVGV4dE5vZGVzID0gISF0ZXh0YXJlYS5maXJzdENoaWxkO1xuICB9XG4gIHJldHVybiBicm93c2VyU3VwcG9ydHNUZXh0YXJlYVRleHROb2Rlcztcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0hUTUxUZXh0QXJlYUVsZW1lbnR8SFRNTElucHV0RWxlbWVudH0gaW5wdXRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0XG4gKiBAcmV0dXJucyB7dm9pZH1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaW5zZXJ0VGV4dEF0UG9zaXRpb24oaW5wdXQ6IEhUTUxUZXh0QXJlYUVsZW1lbnQgfCBIVE1MSW5wdXRFbGVtZW50LCB0ZXh0OiBzdHJpbmcpIHtcbiAgLy8gTW9zdCBvZiB0aGUgdXNlZCBBUElzIG9ubHkgd29yayB3aXRoIHRoZSBmaWVsZCBzZWxlY3RlZFxuICBpbnB1dC5mb2N1cygpO1xuXG4gIC8vIElFIDgtMTBcbiAgaWYgKChkb2N1bWVudCBhcyBhbnkpLnNlbGVjdGlvbikge1xuICAgIGNvbnN0IGllUmFuZ2UgPSAoZG9jdW1lbnQgYXMgYW55KS5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgICBpZVJhbmdlLnRleHQgPSB0ZXh0O1xuXG4gICAgLy8gTW92ZSBjdXJzb3IgYWZ0ZXIgdGhlIGluc2VydGVkIHRleHRcbiAgICBpZVJhbmdlLmNvbGxhcHNlKGZhbHNlIC8qIHRvIHRoZSBlbmQgKi8pO1xuICAgIGllUmFuZ2Uuc2VsZWN0KCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBXZWJraXQgKyBFZGdlXG4gIGNvbnN0IGlzU3VjY2VzcyA9IGRvY3VtZW50LmV4ZWNDb21tYW5kKCdpbnNlcnRUZXh0JywgZmFsc2UsIHRleHQpO1xuICBpZiAoIWlzU3VjY2Vzcykge1xuICAgIGNvbnN0IHN0YXJ0ID0gaW5wdXQuc2VsZWN0aW9uU3RhcnQhO1xuICAgIGNvbnN0IGVuZCA9IGlucHV0LnNlbGVjdGlvbkVuZCE7XG4gICAgLy8gRmlyZWZveCAobm9uLXN0YW5kYXJkIG1ldGhvZClcbiAgICBpZiAodHlwZW9mIGlucHV0LnNldFJhbmdlVGV4dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaW5wdXQuc2V0UmFuZ2VUZXh0KHRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUbyBtYWtlIGEgY2hhbmdlIHdlIGp1c3QgbmVlZCBhIFJhbmdlLCBub3QgYSBTZWxlY3Rpb25cbiAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcbiAgICAgIGNvbnN0IHRleHROb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dCk7XG5cbiAgICAgIGlmIChjYW5NYW5pcHVsYXRlVmlhVGV4dE5vZGVzKGlucHV0KSkge1xuICAgICAgICBsZXQgbm9kZSA9IGlucHV0LmZpcnN0Q2hpbGQ7XG5cbiAgICAgICAgLy8gSWYgdGV4dGFyZWEgaXMgZW1wdHksIGp1c3QgaW5zZXJ0IHRoZSB0ZXh0XG4gICAgICAgIGlmICghbm9kZSkge1xuICAgICAgICAgIGlucHV0LmFwcGVuZENoaWxkKHRleHROb2RlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2Ugd2UgbmVlZCB0byBmaW5kIGEgbm9kZXMgZm9yIHN0YXJ0IGFuZCBlbmRcbiAgICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgICBsZXQgc3RhcnROb2RlID0gbnVsbDtcbiAgICAgICAgICBsZXQgZW5kTm9kZSA9IG51bGw7XG5cbiAgICAgICAgICB3aGlsZSAobm9kZSAmJiAoc3RhcnROb2RlID09PSBudWxsIHx8IGVuZE5vZGUgPT09IG51bGwpKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlTGVuZ3RoID0gbm9kZS5ub2RlVmFsdWUhLmxlbmd0aDtcblxuICAgICAgICAgICAgLy8gaWYgc3RhcnQgb2YgdGhlIHNlbGVjdGlvbiBmYWxscyBpbnRvIGN1cnJlbnQgbm9kZVxuICAgICAgICAgICAgaWYgKHN0YXJ0ID49IG9mZnNldCAmJiBzdGFydCA8PSBvZmZzZXQgKyBub2RlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KChzdGFydE5vZGUgPSBub2RlKSwgc3RhcnQgLSBvZmZzZXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiBlbmQgb2YgdGhlIHNlbGVjdGlvbiBmYWxscyBpbnRvIGN1cnJlbnQgbm9kZVxuICAgICAgICAgICAgaWYgKGVuZCA+PSBvZmZzZXQgJiYgZW5kIDw9IG9mZnNldCArIG5vZGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKChlbmROb2RlID0gbm9kZSksIGVuZCAtIG9mZnNldCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG9mZnNldCArPSBub2RlTGVuZ3RoO1xuICAgICAgICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSWYgdGhlcmUgaXMgc29tZSB0ZXh0IHNlbGVjdGVkLCByZW1vdmUgaXQgYXMgd2Ugc2hvdWxkIHJlcGxhY2UgaXRcbiAgICAgICAgICBpZiAoc3RhcnQgIT09IGVuZCkge1xuICAgICAgICAgICAgcmFuZ2UuZGVsZXRlQ29udGVudHMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIG5vZGUgaXMgYSB0ZXh0YXJlYSBhbmQgdGhlIHJhbmdlIGRvZXNuJ3Qgc3BhbiBvdXRzaWRlIHRoZSBlbGVtZW50XG4gICAgICAvL1xuICAgICAgLy8gR2V0IHRoZSBjb21tb25BbmNlc3RvckNvbnRhaW5lciBvZiB0aGUgc2VsZWN0ZWQgcmFuZ2UgYW5kIHRlc3QgaXRzIHR5cGVcbiAgICAgIC8vIElmIHRoZSBub2RlIGlzIG9mIHR5cGUgYCN0ZXh0YCBpdCBtZWFucyB0aGF0IHdlJ3JlIHN0aWxsIHdvcmtpbmcgd2l0aCB0ZXh0IG5vZGVzIHdpdGhpbiBvdXIgdGV4dGFyZWEgZWxlbWVudFxuICAgICAgLy8gb3RoZXJ3aXNlLCBpZiBpdCdzIG9mIHR5cGUgYCNkb2N1bWVudGAgZm9yIGV4YW1wbGUgaXQgbWVhbnMgb3VyIHNlbGVjdGlvbiBzcGFucyBvdXRzaWRlIHRoZSB0ZXh0YXJlYS5cbiAgICAgIGlmIChjYW5NYW5pcHVsYXRlVmlhVGV4dE5vZGVzKGlucHV0KSAmJiByYW5nZS5jb21tb25BbmNlc3RvckNvbnRhaW5lci5ub2RlTmFtZSA9PT0gJyN0ZXh0Jykge1xuICAgICAgICAvLyBGaW5hbGx5IGluc2VydCBhIG5ldyBub2RlLiBUaGUgYnJvd3NlciB3aWxsIGF1dG9tYXRpY2FsbHkgc3BsaXQgc3RhcnQgYW5kIGVuZCBub2RlcyBpbnRvIHR3byBpZiBuZWNlc3NhcnlcbiAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZSh0ZXh0Tm9kZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBJZiB0aGUgbm9kZSBpcyBub3QgYSB0ZXh0YXJlYSBvciB0aGUgcmFuZ2Ugc3BhbnMgb3V0c2lkZSBhIHRleHRhcmVhIHRoZSBvbmx5IHdheSBpcyB0byByZXBsYWNlIHRoZSB3aG9sZSB2YWx1ZVxuICAgICAgICBjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlLnNsaWNlKDAsIHN0YXJ0KSArIHRleHQgKyB2YWx1ZS5zbGljZShlbmQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENvcnJlY3QgdGhlIGN1cnNvciBwb3NpdGlvbiB0byBiZSBhdCB0aGUgZW5kIG9mIHRoZSBpbnNlcnRpb25cbiAgICBpbnB1dC5zZXRTZWxlY3Rpb25SYW5nZShzdGFydCArIHRleHQubGVuZ3RoLCBzdGFydCArIHRleHQubGVuZ3RoKTtcblxuICAgIC8vIE5vdGlmeSBhbnkgcG9zc2libGUgbGlzdGVuZXJzIG9mIHRoZSBjaGFuZ2VcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ1VJRXZlbnQnKTtcbiAgICBlLmluaXRFdmVudCgnaW5wdXQnLCB0cnVlLCBmYWxzZSk7XG4gICAgaW5wdXQuZGlzcGF0Y2hFdmVudChlKTtcbiAgfVxufVxuIl19